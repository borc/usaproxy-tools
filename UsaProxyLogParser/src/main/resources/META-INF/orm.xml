<?xml version="1.0" encoding="UTF-8"?>

<entity-mappings 
  xmlns="http://java.sun.com/xml/ns/persistence/orm"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://java.sun.com/xml/ns/persistence/orm orm_2_0.xsd"
  version="2.0">

    <package>fi.uta.infim.usaproxylogparser</package>

    <entity class="UsaProxyDOMElement" name="DOMElement">
        <table name="DOMElement" />
        <attributes>
            <id name="id">
                <column name="id"/>
                <generated-value generator="DOMElementseqgenerator" strategy="IDENTITY"/>
                <sequence-generator name="DOMElementseqgenerator" sequence-name="DOMElementseq"/>
            </id>
            <many-to-one name="httpTraffic">
            </many-to-one>
            <one-to-many name="appears" target-entity="UsaProxyAppearanceEvent">
                <join-table name="domelement_appears" />
            </one-to-many>
            <one-to-many name="disappears" target-entity="UsaProxyDisappearanceEvent">
                <join-table name="domelement_disappears" />
            </one-to-many>
            <one-to-many name="events" mapped-by="domPath"></one-to-many>
            <transient name="contents" />
        </attributes>
    </entity>
    
    <entity class="UsaProxyHTTPTraffic" name="HTTPTraffic">
        <table name="HTTPTraffic" />
        <attributes>
            <id name="id">
                <column name="id"/>
                <generated-value generator="HTTPTrafficseqgenerator" strategy="IDENTITY"/>
                <sequence-generator name="HTTPTrafficseqgenerator" sequence-name="HTTPTrafficseq"/>
            </id>
            <many-to-one name="session" />
            <one-to-many name="screens" mapped-by="httpTrafficSession">
                <cascade>
                    <cascade-persist />
                    <cascade-merge />
                </cascade>
            </one-to-many>
            <one-to-many name="domElements" mapped-by="httpTraffic">
            </one-to-many>
            <one-to-one name="entry" mapped-by="httpTrafficSession" />
            <element-collection name="requestHeaders" />
            <element-collection name="responseHeaders" />
            <transient name="address" />
        </attributes>
    </entity>
    
    <entity class="UsaProxyLog" name="Log">
        <table name="Log" />
        <attributes>
            <id name="id">
                <column name="id"/>
                <generated-value generator="Logseqgenerator" strategy="IDENTITY"/>
                <sequence-generator name="Logseqgenerator" sequence-name="Logseq"/>
            </id>
            <one-to-many name="sessions">
                <cascade>
                    <cascade-persist />
                    <cascade-merge />
                </cascade>
            </one-to-many>
            <one-to-many name="entries">
                <cascade>
                    <cascade-persist />
                    <cascade-merge />
                </cascade>
            </one-to-many>
        </attributes>
    </entity>
    
    <entity class="UsaProxyLogEntry" name="LogEntry">
        <table name="LogEntry" />
        <inheritance strategy="JOINED"/>
        <attributes>
            <id name="id">
                <column name="id"/>
                <generated-value generator="LogEntryseqgenerator" strategy="IDENTITY"/>
                <sequence-generator name="LogEntryseqgenerator" sequence-name="LogEntryseq"/>
            </id>
        </attributes>
    </entity>
    
    <entity class="UsaProxyPageEvent" name="PageEvent">
        <table name="PageEvent" />
        <inheritance strategy="SINGLE_TABLE"/>
        <discriminator-value>OTHER</discriminator-value>
        <discriminator-column name="EVENTTYPE" discriminator-type="STRING"/> 
        <attributes>
            <id name="id">
                <column name="id"/>
                <generated-value generator="PageEventseqgenerator" strategy="IDENTITY"/>
                <sequence-generator name="PageEventseqgenerator" sequence-name="PageEventseq"/>
            </id>
            <basic name="type">
                <enumerated>STRING</enumerated>
            </basic>
            <many-to-one name="domPath">
                <cascade>
                    <cascade-persist />
                    <cascade-merge />
                </cascade>
            </many-to-one>
            <many-to-one name="screen">            </many-to-one>
            <many-to-one name="httpTrafficSession">
            </many-to-one>
            <many-to-one name="session">
            </many-to-one>
            <one-to-one name="entry" mapped-by="event" />
            <element-collection name="attributes" />
            
        </attributes>
    </entity>
        
    <entity class="UsaProxyScreen" name="Screen">
        <table name="Screen" />
        <attributes>
            <id name="id">
                <column name="id"/>
                <generated-value generator="Screenseqgenerator" strategy="IDENTITY"/>
                <sequence-generator name="Screenseqgenerator" sequence-name="Screenseq"/>
            </id>
            <many-to-one name="httpTrafficSession">
            </many-to-one>
            <!--<one-to-many name="events" mapped-by="screen"></one-to-many>-->
            <one-to-one name="initialViewportEvent" target-entity="UsaProxyViewportChangeEvent"></one-to-one>
            <one-to-one name="scrollStart" target-entity="UsaProxyScrollStartEvent" />
            <transient name="events" />
        </attributes>
    </entity>
    
    <entity class="UsaProxySession" name="Session">
        <table name="Session" />
        <attributes>
            <id name="id">
                <column name="id"/>
                <generated-value generator="Sessionseqgenerator" strategy="IDENTITY"/>
                <sequence-generator name="Sessionseqgenerator" sequence-name="Sessionseq"/>
            </id>
            <one-to-many name="httpTrafficSessions" mapped-by="session">
            </one-to-many>
            <transient name="sortedHttpTrafficSessions" />
            <transient name="address" />
        </attributes>
    </entity>
    
    <entity class="UsaProxyScrollStartEvent" name="ScrollStartEvent">
        <table name="ScrollStartEvent" />
        <discriminator-value>SCROLLSTART</discriminator-value>
    </entity>
    
    <entity class="UsaProxyAppearanceEvent" name="AppearanceEvent">
        <table name="AppearanceEvent" />
        <discriminator-value>APPEARANCE</discriminator-value>
        <attributes>
        </attributes>
    </entity>
    
    <entity class="UsaProxyDisappearanceEvent" name="DisappearanceEvent">
        <table name="DisappearanceEvent" />
        <discriminator-value>DISAPPEARANCE</discriminator-value>
        <attributes>
        </attributes>
    </entity>
    
    <entity class="UsaProxyViewportChangeEvent" name="ViewportChangeEvent">
        <table name="ViewportChangeEvent" />
        <discriminator-value>VIEWPORTCHANGE</discriminator-value>
    </entity>
    
    <entity class="UsaProxyVisibilityEvent" name="VisibilityEvent">
        <table name="VisibilityEvent" />
        <discriminator-value>VISIBILITY</discriminator-value>
        <attributes>
            <basic name="edge">
                <enumerated>STRING</enumerated>
            </basic>
            <basic name="bottomPosition" />
        </attributes>
    </entity>
    
    <entity class="UsaProxyHTTPTrafficStartEntry" name="HTTPTrafficStartEntry">
        <table name="HTTPTrafficStartEntry" />
        <attributes>
            <one-to-one name="httpTrafficSession">
                <cascade>
                    <cascade-persist />
                    <cascade-merge />
                </cascade>
            </one-to-one>
        </attributes>
    </entity>
    
    <entity class="UsaProxyPageEventEntry" name="PageEventEntry">
        <table name="PageEventEntry" />
        <attributes>
            <one-to-one name="event" target-entity="UsaProxyPageEvent">
                <cascade>
                    <cascade-persist />
                    <cascade-merge />
                </cascade>
            </one-to-one>
        </attributes>
    </entity>
    
</entity-mappings>